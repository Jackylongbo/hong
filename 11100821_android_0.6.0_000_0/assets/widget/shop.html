<!DOCTYPE html>
<html class="um landscape min-width-240px min-width-320px min-width-480px min-width-768px min-width-1024px">
  <head>
    <title>
    </title>
    <meta charset="utf-8">
    <meta name="viewport" content="target-densitydpi=device-dpi, width=device-width, initial-scale=1, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <link rel="stylesheet" href="css/ui-btn.css">
    <link rel="stylesheet" href="css/ui-img.css">
    <link rel="stylesheet" href="css/ui-res.css">
    <link rel="stylesheet" href="css/ui-list.css">
    <link rel="stylesheet" href="css/ui-base.css">
    <link rel="stylesheet" href="css/ui-box.css">
    <link rel="stylesheet" href="css/ui-color.css">
    <script src="js/zy_control.js">
    </script>
    <script src="js/zy_click.js">
    </script>
    <script src="js/public.js">
    </script>
  </head>
<body class="um-vp">
<div id="main">

<!--块容器开始-->
<div class="ub b-gra tx-c">	
 <div id="c1" class="ubr b-gra ub-f1 uinn" onclick="list(0,1);">全部</div>	 
<div id="c2" class="ubr b-gra ub-f1 uinn" onclick="list(65,2);">金饰</div>	
<div id="c3" class="ubr b-gra ub-f1 uinn" onclick="list(66,3);">珠宝</div>	
 <div id="c4" class="ub-f1 uinn" onclick="list(67,4);">钻石</div>
 </div>
<!--块容器结束-->
<!--块容器开始-->
<div class="ub b-gra c-m1 tx-c umar-t">	
 <div id="c5" class="ubr b-gra ub-f1 uinn" onclick="list(68,5);">钟表</div>	 
<div id="c6" class="ubr b-gra ub-f1 uinn" onclick="list(71,6);">其它</div>	
<div id="c7" class="ubr b-gra ub-f1 uinn" onclick="list(70,7);">搜索</div>	
 <div id="c8" class="ub-f1 uinn" onclick="list(72,8);">热卖</div>
 </div>
<!--块容器结束-->



<div id="list"></div>

<div id="more">
<!--块容器开始-->
<div class="ub b-gra">
<div class="b-gra ub-f1 uinn tx-c" ontouchstart="zy_touch('btn-act')" onclick="showmore();">点击查看更多</div>	 
</div>
<!--块容器结束-->
</div>

</div>
</body>
<script>
var page=0;
var sqlstr="";//搜索字符串
var bid=0;
var p=1;
$$("more").style.display = "none";
window.uexOnload=function(type)
{
	list(0,1);
	//setBounceView();
	//getad();
}

function setBounceView(){
	if(window.navigator.platform!='Win32'){
		uexWindow.onBounceStateChange = function (type,status){
			if(type==0 && status==2) {
				uexWindow.resetBounceView("0");
				$$("more").style.display = "none";
				list(0,p);
			}
		}
		uexWindow.setBounce("1");
		uexWindow.notifyBounceEvent("0","1");
		uexWindow.notifyBounceEvent("1","1");
		uexWindow.showBounceView("0", '#F4F4F4', '1');
		uexWindow.showBounceView("1", '#F4F4F4', '1');
	}
}

function list(id,n){
	sqlstr="";//清空搜索字符串。
	bid=id;
	var k=n;
	p=n
	var i=1;
	addClass($$("c"+n),"c-blu2");
	for (i;i<9;i++){
		if(i != k){
			removeClass($$("c"+i), "c-blu2");
		}
	}
	if(n==7){sql();return;}
	getall(0);
}

function addClass(element,value){
if (!element.className)
{
element.className = value;
}
else
{
newClassName = element.className;
newClassName+= " ";
newClassName+= value;
element.className = newClassName;
}
}

function removeClass(elname,value){
newClassName = elname.className;
newClassName=newClassName.replace(/c-blu2/g,"");//替换
elname.className = newClassName;
}

function getall(pages){
		page=pages+1;
		if(page==1){$$("list").innerHTML="";}
		uexWindow.toast("1","5","正在获取...","0");
		var url = "http://www.epawn.cn/json_app/shoplist.asp?page="+page+"&bid="+bid+"&sqlstr="+encodeURIComponent(sqlstr);
		//alert(url);
		uexXmlHttpMgr.onData = getallSuccess;
		uexXmlHttpMgr.open(333, "get", url,"");
		uexXmlHttpMgr.send(333);
}

function getallSuccess(opid,status,result){
		if (status == -1) {
			uexWindow.toast("0","5","服务器端出错或请求超时","3000");
		}
		if(status==1){
		uexXmlHttpMgr.close(333);
		uexWindow.closeToast();
		if(result=="[]"){uexWindow.toast("0","5","暂无更多内容","2000");$$("more").style.display = "none";}
		else{showhtml(result);}
	    }
}

function showhtml(str){
	//alert(str);
	var json = eval(str);
	var jsonlen=json.length;
	var i = 0;
	var html = "";
	for (i; i < jsonlen; i++) {
		if (i % 2 == 0) {
			html+="<div class='ub'>";
		}
		html += "<ul ontouchstart=zy_touch('btn-act') class='ub-f1 uinn' onclick=show("+json[i].id+",'"+encodeURIComponent(json[i].productname)+"');>";
		html += "<li class='us lis-th9 ub-img4' style='background:url(http://www.epawn.cn/kjadmin/uploadpic/"+json[i].pic5+");'></li>";
		html += "<li class='ub-f1 t-blu uinn ut-s tx-c' style='width:8.5em;'>"+json[i].productname+"<br /><span class='t-bla ulev-0'>会员价：¥"+json[i].jiage+"元</span></li>";
		html += "</ul>";
		if(i % 2==1){
		html+="</div>";
		}
	}
	$$("list").innerHTML+=html;
	if (i == 10) {
		$$("more").style.display = "";
	}
	else{
		$$("more").style.display = "none";
	}
}

function showmore(){
	getall(page);
}

function show(id,title){
	localStorage.shopid=id;
	localStorage.infile="shop_show.html";
	localStorage.showstr=decodeURIComponent(title);
	uexWindow.open("shop_dd", '0', "all_list.html", 2, '', '',4);
}

function sql(){
		uexWindow.cbPrompt=function (opId, dataType, data){
            var obj = eval('(' + data + ')');
            if (obj.num == 1) {
                if (obj.value != "") {
					bid=0;//清空
					sqlstr=obj.value;
					getall(0);
                }
            }
        }
            var value = "取 消;搜索";
            var mycars = value.split(";");
            uexWindow.prompt('商品搜索', '请输入关键字：', "", mycars);
}

function getad(){
		var url = "http://www.epawn.cn/json_app/adlist.asp";
		uexXmlHttpMgr.onData = adSuccess;
		uexXmlHttpMgr.open(11, "get", url,"");
		uexXmlHttpMgr.send(11);
}

function adSuccess(opid,status,result){
		if (status == -1) {
			uexWindow.toast("0","5","服务器端出错或请求超时","3000");
		}
		if(status==1){
		uexXmlHttpMgr.close(11);
		if(result=="[]"){return;}
		else{adhtml(result);}
	    }
}

function adhtml(str){
	//alert(str);
	}
</script>
<script src="js/go.js"></script>
</html>